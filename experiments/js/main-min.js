"use strict";function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(o,r){try{var a=t[o](r),c=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(c).then(function(e){i("next",e)},function(e){i("throw",e)});e(c)}return i("next")})}}!function(){var e=426,t=240,n=["user",{exact:"environment"}],i=void 0,o=0,r=0,a={audio:!1,video:{width:1280,height:720}};document.addEventListener("DOMContentLoaded",function(e){var t=document.getElementById("js-media-Resource-file"),o=document.getElementById("js-media_Camera"),r=document.getElementById("js-media_Canvas"),c=document.getElementById("js-cntl_Btn-shooting"),d=document.getElementById("js-cntl_Btn-toggle"),s=r.getContext("2d"),u=void 0;r.width=r.clientWidth,r.height=r.clientHeight;var m=function e(t){t.preventDefault();var n=t.dataTransfer||t.target,i=n&&n.files&&n.files[0];if(!i||"image/jpeg"!==i.type)return void alert("適切なファイルが指定されていません");console.log(i)},f=function e(){var t=[];return new Promise(function(e,n){navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then(function(n){n.forEach(function(e){"videoinput"===e.kind&&t.push({name:e.label,id:e.deviceId})}),e(t)}):MediaStreamTrack.getSources(function(n){n.forEach(function(e){"video"===e.kind&&t.push({name:e.facing,id:e.id})}),e(t)})})},v=function e(){return new Promise(function(e,t){var n=new createjs.LoadQueue;createjs.Sound.alternateExtensions=["mp3"],n.installPlugin(createjs.Sound);var i=[{id:"shooting",type:createjs.Types.SOUND,src:"shared/sounds/shooting-0.mp3"}];n.setMaxConnections(6),n.addEventListener("error",function(e){t(e)}),n.addEventListener("complete",function(t){e(n)}),n.loadManifest(i)})},l=function e(){c.addEventListener("click",function(e){e.preventDefault();var t=window.devicePixelRatio||1,n=loadImage.scale(r,{top:r.height/2-120,left:r.width/2-213,sourceWidth:r.width,sourceHeight:r.height,minWidth:426,maxWidth:426,downsamplingRatio:.5});n.toBlob(function(e){axios({method:"POST",url:"https://westus.api.cognitive.microsoft.com/emotion/v1.0/recognize",headers:{"Content-Type":"application/octet-stream","Ocp-Apim-Subscription-Key":EMOTION_API_KEY},data:e}).then(function(e){console.log(e)}).catch(function(e){console.log(e)})});var i=document.createElement("img");i.src=n.toDataURL("image/png"),document.getElementById("js-media_Src").appendChild(i)}),t.addEventListener("dragover",function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"}),t.addEventListener("dragleave",function(e){e.preventDefault()}),t.addEventListener("drop",m)};!function(){function e(){return t.apply(this,arguments)}var t=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function e(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,f();case 3:return u=c.sent,a.video.facingMode=n[0],c.next=7,navigator.mediaDevices.getUserMedia(a);case 7:return i=c.sent,c.next=10,v();case 10:t=c.sent,l(),o.srcObject=i,function e(){s.drawImage(o,0,0,r.width,r.height),requestAnimationFrame(e)}(),c.next=19;break;case 16:c.prev=16,c.t0=c.catch(0),console.log(c.t0);case 19:case"end":return c.stop()}},e,this,[[0,16]])}));return e}()()},!1)}();